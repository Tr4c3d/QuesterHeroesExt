QuesterHeroesExt
================

[Citizens 1 Quester](https://github.com/CitizensDev/Citizens/tree/master/src/quester) со следующими изменениями:

* Поддержка Heroes
* Несколько новых типов квестов, требований и наград
* Использование требований в шагах квеста
* Возможность повесить несколько квестов на общий cooldown
* Отображаемые имена квестов
* Возможность помещать квесты в несколько файлов
* Локализация
* Нет зависимости от CraftBukkit (`Kill NPC Quest` удален)
* Небольшие минорные изменения


Heroes
------

### Требование по классу или профессии / этапу и уровню

    type: hclass
    classlist: novice;thief;sorcerer;piligrim;admin  # Все эти классы подходят
    secondary: false  # Профа или основной класс
    exact: false  # Проверять класс на точное соответствие со списком, либо родительские классы тоже

    type: hlevel
    max: false  # Максимальное или минимальное требование по этапу и уровню
    tier: 2  # Этап класса
    level: 30
    secondary: false  # Профа или основной класс

### Награда - опыт Heroes в зависимости от этапа класса

    type: hexp
    exp: 500  # Значение по умолчанию
    bytier: "1=500;2=400;3=300"  # Если 1 этап - 500 опыта, если второй - 400, третий - 300. Для остальных - значение 'exp'. Если этого параметра нет - для всех этапов будет использоваться значение 'exp'
    secondary: false  # Профа или основной класс
    take: false  # Вычитать или прибавлять опыт

### Задание - использовать скилл (засчитывается, если скилл использован успешно)

    type: hskill
    name: Blink  # Регистр символов неважен
    amount: 1
    message: Blinked!

### Отключение определенных скиллов на время прохождения квеста

    quest1:
        texts: ...
        repeats: -1
        disabled-skills:
          - Blink
          - Transform
          - Smoke
        ...


Новые типы квестов, требований и наград
---------------------------------------

### Задание - смерть

    type: death
    status-message: 'Ты не можешь умереть во время выполнения этого квеста!'  # Сообщение для /quest status
    message: 'Ты можешь..'

### Задание - выход из игры

    type: quit
    status-message: 'При выходе из игры задание будет провалено!'  # Сообщение для /quest status

### Задания - построить/разбить [определенный] блок в [определенной] локации

    type: build at
    materialid: 98  # опционально
    data: 1  # опционально, только если указано materialid
    location:  # опционально
        x: 804
        y: 64
        z: -504
        world: GalaranDev
    message: Построил!

    type: destroy at
    materialid: 98  # опционально
    data: 1  # опционально, только если указано materialid
    location:  # опционально
        x: 804
        y: 64
        z: -504
        world: GalaranDev
    message: Разбил!

### Задание - написать сообщение в чат, расширенное

    type: chat
    string: 'r#h{3,};i#test;c#heh;si#LOL'  # Строка совпадения
    silent-on-match: true  # опционально, если true - засчитанное сообщение не будет написано в чат
    message: Верно!

Строка совпадения содержит несколько паттернов, разделенных `;`  
Если сообщение подходит под хотя бы один паттерн, оно засчитывается  
Формат паттернов: `флаги#строка`  
Флаги:  
* `i` - игнорировать регистр. Этот флаг также работает вместе с другими
* `s` - сообщение должно начинаться на, например при `is#Lo` - `LOL` подойдёт
* `c` - сообщение должно содержать, например при `c#in` - `mine` подойдёт
* `r` - сопоставление по RegExp, например при `r#h{3,}` - сообщение должно содержать от 3 букв h подряд

Флаги можно комбинировать между собой  
Если флагов нет, сообщение должно точно совпадать с паттерном  

### Требование - количество игроков онлайн

    type: players online                              
    min-online: 2           
    fail-message: "Малый онлайн, требуется минимум 2 игрока"

### Требование - наличие одного из заданных квестов у любого игрока онлайн

    type: online player has quest
    questlist: kill_mobs;quest2
    invert: false  # при true требуется, чтобы никто не выполнял эти квесты
    fail-message: Сейчас никто не выполняет kill_mobs или quest2!
    
### Награда - очистка всех эффектов с игрока (Minecraft и Heroes)

    type: clear effects


Использование требований в шагах квеста
---------------------------------------

    type: hunt
    amount: 3
    string: Zombie,Skeleton
    requirements:
        '0': # в инвентаре должен быть золотой меч
            type: item
            id: 283
            
Когда обжектив обновляется (выполняется полностью или частично), но не соблюдается одно из требований, то он не засчитывается и пишутся сообщения невыполненных требований. Также эти требования пишутся в отчете `/quest status`  


Общее время восстановления
--------------------------

    quest1:
        texts: ...
        repeats: -1
        delay: 5
        ...
    
    quest2:
        texts: ...
        repeats: -1
        delay-share: quest1
        ...

Для `quest2` будет использоваться время восстановления `quest1`  
После выполнения `quest1` или `quest2`, игрок не сможет взять `quest1` и `quest2` в течение 5 минут  


Отображаемые имена квестов, общий статус квеста и переопределение статуса для заданий
-------------------------------------------------------------------------------------

    hg_d1:
        display-name: "&6Куробой"  # это название будет отображаться игрокам
        texts:
            description: ...
            acceptance: ...
            completion: ...
            status: "Это квест на тупое убивание мобов.. Это сообщение будет всегда отображаться вверху при /quest status"
        objectives:
            '0':
                '0':
                    type: hskill
                    name: fireball
                    amount: 1
                    status: "Используй Fireball, чтобы поджарить курицу! Это сообщение заменяет стандартное сообщение обжектива"


Несколько файлов квестов
------------------------

Кроме дефолтного `quests.yml`, есть директория `quests`. В неё можно помещать yml с квестами (имена yml не имеют значения)


Другое
------

### Сообщения для требований и наград

Переопределение стандартного сообщения требования

    type: item
    id: 283
    custom-message: "Без золотого меча ничего не выйдет"

При получении награды, игроку также возможно выводить сообщение
    
    type: clear effects
    custom-message: Вы чувствуете слабость

Мобы, помеченные `summoned-entity` через `entity.setMetadata()` не засчитываются в квест hunt

Названия мобов в hunt quest должны быть, как [здесь](https://github.com/Bukkit/Bukkit/blob/master/src/main/java/org/bukkit/entity/EntityType.java) (в "", не считая регистр символов)


Download
--------

https://dl.dropbox.com/u/14150510/dd/mccity/quester/Quester_Heroes.jar

Скопировать в `Citizens/types`  
**Важно!** Стандартный Quester.jar нужно убрать из этой директории (переименование не пройдет!)  

#### Локализция (ru):  
https://dl.dropbox.com/u/14150510/dd/mccity/quester/quester.lang  
Положить в `Citizens`  

#### Исходный Код

https://github.com/galaran/QuesterHeroesExt  