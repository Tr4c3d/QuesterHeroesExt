QuesterHeroesExt
================

[Citizens 1 Quester](https://github.com/CitizensDev/Citizens/tree/master/src/quester) со следующими изменениями:

* Возможность помещать квесты в разные файлы
* Поддержка Heroes
* Несколько новых типов квестов
* Отображаемые имена квестов
* Локализация
* Нет зависимости от CraftBukkit (`Kill NPC Quest` удален)
* Небольшие минорные изменения

Разные файлы для квестов
------------------------

Кроме дефолтного `quests.yml`, есть директория `quests`. В неё можно помещать yml с квестами (имена yml не имеют значения)

Heroes
------

### Требование по классу или профессии / этапу и уровню

    requirements:
        '0':
            type: hclass
            classlist: novice;thief;sorcerer;piligrim;admin  # Все эти классы подходят
            secondary: false  # Профа или основной класс
            exact: false  # Проверять класс на точное соответствие со списком, либо родительские классы тоже
        '1':
            type: hlevel
            max: false  # Максимальное или минимальное требование по этапу и уровню
            tier: 2  # Этап класса
            level: 30
            secondary: false  # Профа или основной класс


### Награда / вычитание опыта Heroes в зависимости от этапа класса

    rewards:
        '0':
            type: hexp
            exp: 500  # Значение по умолчанию
            bytier: "1=500;2=400;3=300"  # Если 1 этап - 500 опыта, если второй - 400, третий - 300. Для остальных - значение 'exp'. Если этого параметра нет - для всех этапов будет использоваться значение 'exp'
            secondary: false  # Профа или основной класс
            take: false  # Вычитать или прибавлять опыт

### Задание - использовать скилл (засчитывается, если скилл использован успешно)

    '0':
        type: hskill
        name: Blink  # Регистр символов неважен
        amount: 1
        message: Blinked!


Новые типы квестов
------------------

### Задание - смерть

    '0':
        type: death
        status-message: 'Ты не можешь умереть во время выполнения этого квеста!'  # Сообщение для /quest status
        message: 'Ты можешь..'

### Задание - выход из игры

    '0':
        type: quit
        status-message: 'При выходе из игры задание будет провалено!'  # Сообщение для /quest status

### Задания - построить/разбить [определенный] блок в [определенной] локации

    '0':
        type: build at
        materialid: 98  # опционально
        data: 1  # опционально, только если указано materialid
        location:  # опционально
            x: 804
            y: 64
            z: -504
            world: GalaranDev
        message: Построил!
    
    '1':
        type: destroy at
        materialid: 98  # опционально
        data: 1  # опционально, только если указано materialid
        location:  # опционально
            x: 804
            y: 64
            z: -504
            world: GalaranDev
        message: Разбил!

### Задание - написать сообщение в чат, расширенное

    '0':
        type: chat
        string: 'r#h{3,};i#test;c#heh;si#LOL'  # Строка совпадения
        silent-on-match: true  # опционально, если true - засчитанное сообщение не будет написано в чат
        message: Верно!

Строка совпадения содержит несколько паттернов, разделенных `;`  
Если сообщение подходит под хотя бы один паттерн, оно засчитывается  
Формат паттернов: `флаги#строка`  
Флаги:  
* `i` - игнорировать регистр. Этот флаг также работает вместе с другими
* `s` - сообщение должно начинаться на, например при `is#Lo` - `LOL` подойдёт
* `c` - сообщение должно содержать, например при `c#in` - `mine` подойдёт
* `r` - сопоставление по RegExp, например при `r#h{3,}` - сообщение должно содержать от 3 букв h подряд

Флаги можно комбинировать между собой  
Если флагов нет, сообщение должно точно совпадать с паттерном  

Отображаемые имена квестов, общий статус квеста и переопределение статуса для заданий
-------------------------------------------------------------------------------------

    hg_d1:
        display-name: "&6Куробой"  # это название будет отображаться игрокам
        texts:
            description: ...
            acceptance: ...
            completion: ...
            status: "Это квест на тупое убивание мобов.. Это сообщение будет всегда отображаться вверху при /quest status"
        objectives:
            '0':
                '0':
                    type: hskill
                    name: fireball
                    amount: 1
                    status: "Используй Fireball, чтобы поджарить курицу! Это сообщение заменяет стандартное сообщение обжектива"

Другое
------

Если при смерти игрока / моба его `lastDamageCause` равен `null`, смерть не засчитывается в квесты

Мобы, помеченные `summoned-entity` через `entity.setMetadata()` не засчитываются в квест hunt

Названия мобов в hunt quest должны быть, как [здесь](https://github.com/Bukkit/Bukkit/blob/master/src/main/java/org/bukkit/entity/EntityType.java) (то, что красным в "", не считая регистр символов):    

Download
--------

https://dl.dropbox.com/u/14150510/dd/mccity/quester/Quester_Heroes.jar

Скопировать в `Citizens/types`  
**Важно!** Стандартный Quester.jar нужно убрать из этой директории (переименование не пройдет!)  

#### Локализция (ru):  
https://dl.dropbox.com/u/14150510/dd/mccity/quester/quester.lang  
Положить в `Citizens`  

#### Исходный Код

https://github.com/galaran/QuesterHeroesExt  